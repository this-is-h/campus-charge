# NXU Charge Go

这里是一个 `Golang` 服务器的示例

### 配置

1. 需要配置你自己的 `MySQL` 路径，数据表的生成可以参考 [README.md](../php/README.md#准备---prephp)
2. 需要自行爬取官方接口 `Header` 中 `clientid` 的值

### 运行

使用 `go run main.go` 命令运行后，会监听 `127.0.0.1:2254` ，有以下两个访问路径：

1. #### `/update-data`

    访问该路径会对数据进行更新。

2. #### `/get-data`

    * ##### 请求参数说明
    
    | 参数 |  必选 |  类型  |        说明      |          备注         |
    | ---- | ---- | ------ | ---------------- | -------------------- |
    | pile | True | String | 要获取的充电桩代码 | 例：`c14` `a2` `b10` |

    访问该路径可以获取到某处充电桩数据。

### 问题

* 更新数据时，只根据充电开始时间和购买时长计算（add）得到预计的结束时间并更新数据库，但实际情况可能因为充满电或是被拔掉等提前结束。暂未修复。
* 获取数据部分尚未进行输入参数验证，可能存在注入风险。
* 尚未探究 `goroutine` 的可行性。

### 碎碎念

因为正在学习 `Golang` ，于是最开始使用golang实现了这两个功能，当时服务器使用 `Termux` 、 `KSWEB` 和 `HP-PRO` 在安卓手机上搭建，由于 `Termux` 的 `cronie` 一直配置失败，所以采取了使用 `KSWEB` 定时执行php文件访问链接的方法更新数据，于是将更新数据和获取数据写到了一个服务器内。后来由于迁移到虚拟主机，无法配置golang环境，遂转向php，暂时停止了对golang示例的维护。